---
title: "p8105_hw_nkr2121"
author: "Nihaal Rahman"
output: github_document
---

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1

Let's begin by loading in pols_month data set and cleaning it up. 

```{r}
pols <- read_csv("~/Documents/Columbia/Semester 3/Data1/fivethirtyeight_datasets/pols-month.csv") |> 
  separate(mon, into = c("year", "month", "day"), sep = '-') |> 
  mutate(month = month.name[as.numeric(month)],
         year = as.numeric(year),
         president = case_when(
           as.numeric(prez_gop) > 0 ~ "gop",
           as.numeric(prez_dem) > 0 ~ "dem"
         )) |> 
  select(-c("prez_dem", "prez_gop", "day"))
```

Now moving on to the snp data set.  

```{r}
snp <- read_csv("~/Documents/Columbia/Semester 3/Data1/fivethirtyeight_datasets/snp.csv") |> 
  separate(date, into = c("month", "day", "year"), sep = '/') |> 
  mutate(year = as.numeric(year),
         year = case_when(
           year < 23 ~ 2000 + year),
         month = month.name[as.numeric(month)]) |> 
  arrange("year", "month") |> 
  select(c("year", "month", "close"))
```

Now moving onto the unemployment data set. 

```{r}
unemployment <- read_csv("~/Documents/Columbia/Semester 3/Data1/fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    cols = c("jan","feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec"),
    names_to = "month",
    values_to = "unemployment_rate") |> 
  mutate(year = as.numeric(year),
         month = case_match(
    month,
    "jan" ~ "January",
    "feb" ~ "February",
    "mar" ~ "March",
    "apr" ~ "April",
    "may" ~ "May",
    "jun" ~ "June",
    "jul" ~ "July",
    "aug" ~ "August",
    "sep" ~ "September",
    "oct" ~ "October",
    "nov" ~ "November",
    "dec" ~ "December"
    ))
```

Now I will merge the datasets together. 

```{r}
problem1 = left_join(pols, snp, by=c("year","month")) |> 
  left_join(unemployment, by=c("year","month"))
```

In the first step, we pulled in and cleaned the the pols data set. After cleaning, this data set has 9 variables: year, month, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, and president. The year and month variables tell us when the count was recorded. The gov_gop and gov_dem variables tell us how many governors were republicans or democrats, respectively, when the count was taken. The sen_gop and sen_dem variables tell us how many senators were republicans or democrats, respectively, when the count was taken. The rep_gop and rep_dem variables tell us how many house members were republicans or democrats, respectively, whe nthe count was taken. Finally, the president variable tells us if the president at the time was republican or democrat when the count was taken. 

In the next step, we pulled in and cleaned the snp data set. After cleaning, this data set has 3 variables: year, month, and close. The year and month variables tell us when the observation was taken, and the close variable tells us the closing values of the S&P stock index on the associated date. 

In the following step, we pulled in and cleaned the unemployment data set. After cleaning, this data set has 3 variables: year, month, and unemployment_rate. The year and month variables tell us the date of observation, and the unemployement_rate variable tells us the percentage of unemployment on the given year/month 

I then merged these 3 data sets into a new data set titled "problem1". This dataset has 11 variables (year, month, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president, close, unemployment_rate). This dataset has 822 rows.

## Problem 2

First, importing the Mr. Trashwheel data

```{r}
mrtrashwheel = read_excel("~/Documents/Columbia/Semester 3/Data1/202309 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N586") |> 
  janitor::clean_names() |> 
  mutate(name = "mrtrash",
         homes_powered = (weight_tons * 500) / 30)
```

Next, doing the same for Professor Trashwheel

```{r}
proftrashwheel = read_excel("~/Documents/Columbia/Semester 3/Data1/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M108") |> 
  janitor::clean_names() |> 
  mutate(name = "proftrash",
         homes_powered = (weight_tons * 500) / 30)
```

Finally, doing the same for Gwynnda

```{r}
gwynnda = read_excel("~/Documents/Columbia/Semester 3/Data1/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", range = "A2:L157") |> 
  janitor::clean_names() |> 
  mutate(name = "gwynnda",
         homes_powered = (weight_tons * 500) / 30)
```














